# VTRIA ERP Security Configuration Template
# Copy this file to .env and update with actual values
# NEVER commit .env files to version control

# =============================================================================
# AUTHENTICATION & JWT CONFIGURATION
# =============================================================================

# JWT Secrets (Generate with: openssl rand -base64 64)
JWT_SECRET=your-256-bit-secret-key-here
JWT_REFRESH_SECRET=your-256-bit-refresh-secret-key-here

# JWT Expiration Times
JWT_EXPIRATION=8h
JWT_REFRESH_EXPIRATION=30d

# Session Secret
SESSION_SECRET=your-session-secret-key-here

# =============================================================================
# DATABASE SECURITY
# =============================================================================

# Database Encryption Key (Generate with: openssl rand -base64 32)
DB_ENCRYPTION_KEY=your-database-encryption-key-here

# Database Connection Security
DB_SSL_CA=/path/to/ca-certificate.pem
DB_SSL_CERT=/path/to/client-certificate.pem  
DB_SSL_KEY=/path/to/client-key.pem

# =============================================================================
# API SECURITY
# =============================================================================

# Rate Limiting Secret
API_RATE_LIMIT_SECRET=your-rate-limit-secret-here

# CORS Configuration
CORS_ORIGINS=http://localhost:3000,https://vtria-erp.com

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# Email Service (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@company.com
SMTP_PASS=your-app-specific-password

# Cloud Storage (if applicable)
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGION=us-east-1
AWS_S3_BUCKET=your-s3-bucket-name

# Payment Gateway (if applicable)
PAYMENT_GATEWAY_API_KEY=your-payment-gateway-key
PAYMENT_GATEWAY_SECRET=your-payment-gateway-secret

# =============================================================================
# SECURITY MONITORING
# =============================================================================

# External Logging Service
LOG_SERVICE_URL=https://your-logging-service.com/api
LOG_SERVICE_API_KEY=your-logging-service-key

# Security Monitoring
SECURITY_WEBHOOK_URL=https://your-security-monitoring.com/webhook

# =============================================================================
# ENCRYPTION & HASHING
# =============================================================================

# Bcrypt Rounds (Recommended: 12-15)
BCRYPT_ROUNDS=12

# File Upload Encryption Key
FILE_ENCRYPTION_KEY=your-file-encryption-key-here

# =============================================================================
# DEVELOPMENT SECURITY
# =============================================================================

# Development Mode (NEVER set to true in production)
DEVELOPMENT_MODE=false

# Bypass Authentication (ONLY for development)
BYPASS_AUTH=false

# Debug Mode (NEVER enable in production)
DEBUG_MODE=false

# =============================================================================
# PRODUCTION SECURITY
# =============================================================================

# Force HTTPS
FORCE_HTTPS=true

# Secure Headers
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_URI=/api/security/csp-report

# =============================================================================
# BACKUP & RECOVERY
# =============================================================================

# Backup Encryption Key
BACKUP_ENCRYPTION_KEY=your-backup-encryption-key-here

# Backup Storage Credentials
BACKUP_STORAGE_ACCESS_KEY=your-backup-storage-key
BACKUP_STORAGE_SECRET_KEY=your-backup-storage-secret

# =============================================================================
# COMPLIANCE & AUDITING
# =============================================================================

# Audit Log Retention (days)
AUDIT_LOG_RETENTION=365

# Compliance Mode (enables additional security measures)
COMPLIANCE_MODE=true

# Data Retention Period (days)
DATA_RETENTION_PERIOD=2555  # 7 years

# =============================================================================
# NOTIFICATION SETTINGS
# =============================================================================

# Security Alert Email
SECURITY_ALERT_EMAIL=security@company.com

# Incident Response Team
INCIDENT_RESPONSE_EMAIL=incident-response@company.com

# =============================================================================
# SECURITY VALIDATION
# =============================================================================

# Password Policy
MIN_PASSWORD_LENGTH=12
REQUIRE_UPPERCASE=true
REQUIRE_LOWERCASE=true
REQUIRE_NUMBERS=true
REQUIRE_SPECIAL_CHARS=true
PASSWORD_HISTORY_COUNT=5

# Account Lockout Policy
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15

# Session Security
SESSION_TIMEOUT_MINUTES=480  # 8 hours
IDLE_TIMEOUT_MINUTES=60

# =============================================================================
# FILE UPLOAD SECURITY
# =============================================================================

# Maximum file sizes (in bytes)
MAX_FILE_SIZE=10485760  # 10MB
MAX_TOTAL_SIZE=104857600  # 100MB

# Allowed file types (MIME types)
ALLOWED_FILE_TYPES=application/pdf,application/msword,application/vnd.ms-excel,image/jpeg,image/png

# Virus scanning (if enabled)
VIRUS_SCAN_ENABLED=false
VIRUS_SCAN_API_KEY=your-virus-scan-api-key

# =============================================================================
# NETWORK SECURITY
# =============================================================================

# Trusted IP Ranges (comma-separated CIDR blocks)
TRUSTED_IP_RANGES=192.168.1.0/24,10.0.0.0/8

# Firewall Rules
ENABLE_IP_WHITELIST=false
BLOCKED_IP_RANGES=

# =============================================================================
# MONITORING & ALERTING
# =============================================================================

# Enable security monitoring
SECURITY_MONITORING_ENABLED=true

# Alert thresholds
FAILED_LOGIN_THRESHOLD=10
SUSPICIOUS_ACTIVITY_THRESHOLD=50

# Monitoring intervals (minutes)
HEALTH_CHECK_INTERVAL=5
SECURITY_SCAN_INTERVAL=60

# =============================================================================
# ENCRYPTION SETTINGS
# =============================================================================

# Default encryption algorithm
DEFAULT_ENCRYPTION_ALGORITHM=AES-256-GCM

# Key rotation interval (days)
KEY_ROTATION_INTERVAL=90

# =============================================================================
# CERTIFICATE MANAGEMENT
# =============================================================================

# SSL Certificate Paths
SSL_CERT_PATH=/path/to/ssl/certificate.pem
SSL_KEY_PATH=/path/to/ssl/private-key.pem

# Certificate Auto-renewal
AUTO_RENEW_CERTS=true
CERT_RENEWAL_DAYS_BEFORE=30

# =============================================================================
# SECURITY HEADERS
# =============================================================================

# X-Frame-Options
X_FRAME_OPTIONS=DENY

# X-Content-Type-Options
X_CONTENT_TYPE_OPTIONS=nosniff

# X-XSS-Protection
X_XSS_PROTECTION=1; mode=block

# Referrer Policy
REFERRER_POLICY=strict-origin-when-cross-origin

# =============================================================================
# NOTES
# =============================================================================

# 1. Generate strong secrets using: openssl rand -base64 64
# 2. Use different secrets for each environment (dev, staging, prod)
# 3. Rotate secrets regularly (every 90 days)
# 4. Store production secrets in secure vault (not in files)
# 5. Never commit .env files to version control
# 6. Use environment-specific configurations
# 7. Regularly audit and update security settings
# 8. Test security configurations in staging before production
# 9. Monitor security logs and alerts
# 10. Keep this template updated with new security requirements